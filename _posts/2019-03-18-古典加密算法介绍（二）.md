---
layout: post
title:  "古典加密算法介绍（二）"
categories: 知识
tags:  密码学 可视化 信息安全
author: littleRound
comment: true
excerpt: 最近学网络安全学到对称加密系统这个部分，感觉看书大段文字效率很低，所以很自然的想做一下可视化，既方便自己复习，也方便他人参考；第（二）篇主要介绍对称加密中的多字母密码表以及其他基于换位的加密技术。
---

* content
{:toc}

{% raw %}

# 古典加密算法介绍（二）



前一篇：[【古典加密算法介绍（一）】](https://littleround.cn/2019/03/05/%E5%8F%A4%E5%85%B8%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95%E4%BB%8B%E7%BB%8D-%E4%B8%80/)

## 前言

上一篇中介绍了对称加密的一些基本概念并给出了一些**基于置换**的基本加密算法。本篇将继续就置换加密中的**多字母密码表**以及另一类**基于换位**的古典加密算法做一介绍。

## 相关算法

### 维吉尼亚密码（Vigenère Cipher）

- 基于置换
- 属于**多字母密码表**的一种（即在加密过程中使用不同的字母置换的方法）
- 密钥是字符串
- 加密过程：拓展密钥（循环反复），转换为数字相加取模并转换回来
- 解密过程：类似加密，变为密文和密钥的减法
- 破解方式：通过相同子串的公约数可大致猜出密钥长度（循环节），再对于每个周期同一个位置进行单表置换密码类似的破解即可

![Vigenere](/static/post_resource/2019-03-18-1.gif)

### 维尔南密码（Vernam Cipher)

- 基于置换
- 属于**多字母密码表**的一种
- 通过一个**密钥流生成器**（key stream generator）来持续生成二进制密钥（密钥流生成器是通过有限的密钥决定的）
- 加密过程：将信息转换为二进制，通过将明文与生成密钥进行**异或操作**来达到加密效果
- 解密过程：由于**异或操作可逆**，两边**共享**生成器，故再进行异或可得到明文
- 破解方式：由于密钥流生成器信息量有限，其生成的密钥也会在一定长度后**重复循环之前的结果**，故弱点与维吉尼亚密码相同

![Vernam](/static/post_resource/2019-03-18-2.gif)

### 一次性密码本（One-time Pad or OTP）

- 基于置换
- 属于**多字母密码表**的一种
- 加密解密过程与**维尔南密码**类似
- 将**维尔南密码**中的**生成密钥**换成**预先给好**的密码本
- 密码本长度足够长，**不循环使用**
- 由于密钥使用一次就丢弃，所以**理论上无法破解**

>加密解密过程与**维尔南密码**类似，**故不再重复给出图示**

### 栅栏密码（Rail Fence Cipher）

- 基于换位
- 方法较为原始，**无密钥**
- 加密过程：将原序列**奇偶拆分**，输出奇数序列+偶数序列
- 解密过程：序列二分，进行归并
- 破解方式：重组即可

![RF](/static/post_resource/2019-03-18-3.gif)

### 交换列顺序（permute the order of columns）

- 基于换位
- 密钥是一个1-n的**排列**
- 加密过程：将原序列按密钥长度**切分**，每段写在一行上；再**按照密钥标明的列顺序**写成密文
- 解密过程：拼回去
- 破解方式：**二连字**或**三连字频率分析**的攻击
- 栅栏密码**可以看作**交换列顺序的一类特殊情况

![permute_col](/static/post_resource/2019-03-18-4.gif)

### 转轮机（Rotor Machines）

- 基于置换和换位（密钥换位）
- 指代**一类系统**（而非单种）
- 历史中有机械原型（**如恩尼格玛（Enigma）密码机**），可参考[WIKI资料](https://en.wikipedia.org/wiki/Rotor_machine)。
- 加密过程（某种转轮机的一个例子）：
  - 转轮机有**三个转子**，每个**转子**有26个状态，对应26种**单表置换密码**（见[【古典加密算法介绍（一）】](https://littleround.cn/2019/03/05/%E5%8F%A4%E5%85%B8%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95%E4%BB%8B%E7%BB%8D-%E4%B8%80/)）
  - 三个转子依照与操作器由近到远（也就是先计算的较近）分为快、中、慢
  - 任何时刻，转轮机会处于**某个状态**，加密和解密用的密码机**初始状态相同**
  - **一个状态**指代其**三个转子状态组成的唯一元组**
  - 当输入一个字母时，按照当前状态**依次**进行三次单表置换输出一个字母，并使得转轮机**进入下一个状态**
  - 下一个状态指：**快转子**向下旋转一次（换成另一种单表）
  - 需要注意的是，**快转子**每转26次，**中转子**会转一次；**中转子**每转26次，**慢转子**会转一次
  - 将明文一个字母一个字母输入转轮机即可输出密文
- 解密过程：
  - 构造完全模拟**加密转轮机**，但**单表置换复合结果为加密结果逆**的**解密转轮机**
  - 和**加密转轮机**类似，将密文一个字母一个字母输入**解密转轮机**即可输出明文
- 破解较为困难，需要亿级别的密文才能进行较为有效的分析

![rotor](/static/post_resource/2019-03-18-5.gif)

## 结语

关于古典加密算法的介绍到这里就结束了。

书中还提到了一些关于**隐写术**（steganography）的内容，如铅笔描字、隐形墨水、针孔标记、无墨打字、藏头首字母等远古级技巧，虽然十分有趣但在本文讨论范围之外。

对于DES（3DES）、AES等现代投入生产实践的算法，后面有时间再单开专题，如果有人想看的话可以给我发邮件催更，也可以在下方评论区留言（需要小飞机）。

{% endraw %}